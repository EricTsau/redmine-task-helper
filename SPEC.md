# Redmine Task Helper 設計規格書 (Design Specification)

## 1. 專案概述
本專案為一個專為 Redmine 使用者設計的桌面/網頁輔助工具，旨在提升任務管理、工時追蹤以及專案規劃的效率。透過整合 AI 技術，提供智慧化的 PRD 生成、任務拆解、自動工時總結及互動式甘特圖功能。

## 2. 核心功能模組

### 2.1 任務管理 (Task Workbench)
- **我的任務**: 顯示指派給當前使用者的 Redmine 任務。
- **關注任務**: 追蹤特定專案或成員的任務。
- **樹狀視圖**: 以階層結構顯示任務與子任務關係。
- **快速編輯**: 直接在介面上修改任務狀態、優先級及備註。

### 2.2 工時追蹤 (Time Tracking)
- **計時器**: 支援持續計時、暫停與恢復功能。
- **自動同步**: 計時完成後可自動或手動將工時紀錄回寫至 Redmine。
- **遺忘保護**: 若連續計時超過 4 小時未操作，系統會自動停止並提醒。
- **離線支援**: 網路不穩定時，紀錄會暫存於本地資料庫，待恢復後同步。

### 2.3 AI PM Copilot
- **AI PRD 對話**: 側邊欄對話介面，協助釐清需求並生成 PRD 文件。
- **自動任務拆解**: AI 根據 PRD 自動拆解 WBS，生成預估工時、開始日與由於日期。
- **互動式甘特圖**: 
    - 視覺化管理任務時程。
    - 支援拖拉（Drag & Drop）調整任務時長及相依性。
    - 顏色區分狀態（例如：延遲、進行中、已完成）。
- **Redmine 同步**: 規劃好的任務可一鍵建立或同步至 Redmine Issue。

### 2.4 AI 工作總結 (AI Work Summary)
- **自動週報**: 根據 Redmine 的工時紀錄與任務更新，自動生成 Markdown 格式的工作總結。
- **智慧標題**: AI 自動從內容中提取合適的標題。
- **超連結整合**: 自動生成對應 Redmine Issue 的超連結。
- **多項目彙整**: 支援多個專案或成員的工作內容總結。

### 2.5 行政管理 (Administration) & 設定
- **假日管理**: 
    - 設定週末及自定義假日。
    - 甘特圖排程自動跳過非工作日。
- **使用者與權限**: 整合 LDAP 驗證或標準帳號管理，設置管理員權限。
- **系統配置**: 設定 Redmine URL、API Token 以及 OpenAI 模型參數。

## 3. 技術架構

### 3.1 後端 (Backend)
- **框架**: FastAPI (Python)
- **資料庫**: SQLite (使用 SQLModel/SQLAlchemy)
- **版控**: Alembic (遷移腳本規範：`{序號}_{日期時間}_{描述}.py`)
- **服務**: 
    - `RedmineService`: 處理與 Redmine API 的所有通訊。
    - `OpenAIService`: 處理 LLM 請求與 Prompt 管理。
    - `WorkdayCalculator`: 計算工作日與排除假日邏輯。

### 3.2 前端 (Frontend)
- **框架**: React 19 (使用 Vite)
- **樣式**: Tailwind CSS, Shadcn UI
- **設計風格**: 
    - 淺色現代科技風 (毛玻璃效果、漸層邊框、圓角)。
    - RWD 響應式佈局。
- **通訊**: 使用 Axios 與後端 API 交互。
- **多國語系**: 使用 `react-i18next` 支援繁體中文 (zh-TW) 與英文 (en)。

## 4. UI/UX 規範
- **訊息提醒**: 
    - 禁止使用原生 `alert()`。
    - 統一使用右下角圓角 Toast 通知 (`useToast()` hook)。
- **日期顯示**: 統一格式為 `年 -> 月 -> 日 -> 時 -> 分 -> 秒`。
- **導航**: 支援 `Cmd+K` / `Ctrl+K` 全局命令面板導航。

## 5. 部署與開發環境
- **環境管理**: 支援 Docker Compose 一鍵部署。
- **虛擬環境**: Python 需使用 venv，Node.js 使用 npm。
- **測試**: 
    - 後端使用 Pytest。
    - 前端使用 Vitest。

## 6. 其他規範
- **語言**: 思想、程式註解及文件一律優先使用 **繁體中文**。
- **安全性**: 憑證資訊僅儲存於本地資料庫，不應外洩。
